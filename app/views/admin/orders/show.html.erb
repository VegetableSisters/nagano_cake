<div class="container">
  <h3>注文履歴詳細</h3>
  <div class="row">
    <div class="col-12">
      <table class="table">
        <thead>
          <tr>
            <td>購入者</td>
            <td>注文日</td>
            <td>配送先</td>
            <td>支払方法</td>
            <td>注文ステータス</td>
          </tr>

        </thead>
        <tbody>
<% @order_details.each do |order_detail| %>
          <tr>
            <td><%= link_to @order.name, admin_customers_path %></td>
            <td><%= @order.created_at.strftime("%Y/%m/%d") %></td>
            <td><%= @order.postal_code_and_address_and_name %></td>
            <td><%= @order.payment_method_i18n %></td>
            <td>
      <%= form_with model: order_detail, url: admin_order_detail_path(order_detail), method: :patch do |f| %>
        <%= f.select :production_status, OrderDetail.production_statuses.keys.map { |status| [OrderDetail.human_attribute_name("production_status.#{status}"), status] }, {}, class: "form-control" %>
        <%= f.submit "更新", class: "btn btn-success btn-sm" %>
      <% end %>
    </td>
          </tr>
          <% end %>

        </tbody>

      </table>
    </div>

    <div class="col-12">
      <table class="table">
        <thead>
          <tr class="bg-light">
            <th>商品名</th>
            <th>単価（税込）</th>
            <th>数量</th>
            <th>小計</th>
            <th>製作ステータス</th>
          </tr>
        </thead>
        <tbody>
          <% @order_details.each do |order_detail| %>

          <tr>
            <td><%= order_detail.item.name %></td>
                <td><%= order_detail.item.price %></td>
                <td><%= order_detail.amount %></td>
                <td><%= order_detail.amount * order_detail.item.price %></td>
            <td>
  <%= form_with model: order_detail, url: admin_order_detail_path(order_detail), method: :patch do |f| %>
    <%= f.select :production_status, OrderDetail.production_statuses.keys.map { |status| [OrderDetail.human_attribute_name("production_status.#{status}"), status] }, {}, class: "form-control" %>
    <%= f.submit "更新", class: "btn btn-success btn-sm" %>
  <% end %>
</td>
          </tr>

          <% end %>
        </tbody>
      </table>
    </div>


    <div class="col-4">
      <table class="table">
          <tr>
            <th>商品合計</th>
            <th>送料</th>
            <th>請求合計</th>
          </tr>

          <tr>
            <td><%= @order.total_payment %>円</td>
            <td><%= @order.shipping_cost %>円</td>
            <td><%= @order.total_payment + @order.shipping_cost %>円</td>
          </tr>

      </table>
      
    </div>
  </div>
</div>
